
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Android Developer Fundamentals 02.1: Activities と intents</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="2-1"
                  title="Android Developer Fundamentals 02.1: Activities と intents"
                  environment="web"
                  feedback-link="">
    
      <google-codelab-step label="Welcome" duration="0">
        <p>この実践的なコードラボは<a href="https://developer.android.com/courses/fundamentals-training/toc-v2#unit_1_get_started" target="_blank">ユニット 1:</a>Android Developer Fundamentals (Version 2) コースの一部です。このコースでは、コードラボを順番に学習することで、このコースを最大限に活用することができます。</p>
<ul>
<li>コースのコードラボの完全なリストについては、<a href="https://developer.android.com/courses/fundamentals-training/toc-v2" target="_blank">Codelabs for Android Developer Fundamentals (V2)</a>を参照してください。</li>
<li>すべてのコンセプトチャプター、アプリ、スライドへのリンクを含むコースの詳細については、Android Developer<a href="https://developer.android.com/courses/fundamentals-training/overview-v2" target="_blank">Fundamentals (Version 2)</a>を参照してください。</li>
</ul>
<p>注：このコースでは、「Codelab」と「実践」という用語を入れ替えて使用しています。</p>
<p>序章</p>
<p>クラスの <a href="https://developer.android.com/reference/android/app/Activity.html" target="_blank">活動内容</a>は、写真の撮影、電子メールの送信、マップの表示など、ユーザーが1つの集中的なタスクを実行できるアプリ内の1つの画面を表します。アクティビティは通常、フルスクリーン ウィンドウとしてユーザーに表示されます。</p>
<p>アプリは通常、互いにゆるやかに結合された複数の画面で構成されています。各画面はアクティビティです。通常、アプリ内の1つのアクティビティは「メイン」アクティビティ（MainActivity.java）として指定され、アプリの起動時にユーザーに表示されます。メイン アクティビティは、他のアクティビティを開始して、異なるアクションを実行することができます。</p>
<p>新しいアクティビティが開始されるたびに、前のアクティビティは停止しますが、システムはスタック（「バックスタック」）にアクティビティを保持します。新しいアクティビティが開始されると、その新しいアクティビティはバックスタックにプッシュされ、ユーザーのフォーカスを受けます。バックスタックは基本的な「last in, first out」スタックロジックに従います。ユーザーが現在のアクティビティを終了してBackボタンを押すと、そのアクティビティはスタックからポップされて破棄され、前のアクティビティが再開されます。</p>
<p>アクティビティは、意図を持って開始またはアクティベートされます。アクティビティは <a href="https://developer.android.com/reference/android/content/Intent.html" target="_blank">インテント</a>は非同期メッセージで、他のアクティビティや他のアプリコンポーネントからアクションを要求するためにアクティビティ内で使用できます。インテントを使用して、別のアクティビティからアクティビティを開始したり、アクティビティ間でデータを渡したりすることができます。</p>
<p>インテントには、明示的なものと暗黙的なものがあります。</p>
<ul>
<li>明示的なインテントとは、そのインテントのターゲットが分かっているものです。つまり、特定のアクティビティの完全修飾クラス名がすでにわかっているということです。</li>
<li>暗黙的なインテントは、ターゲットコンポーネントの名前は知らないが、実行すべき一般的なアクションがある場合のものです。</li>
</ul>
<p>この実習では、明示的なインテントを作成します。暗黙的インテントの使用方法については、後で説明します。</p>
<p>すでに知っておくべきこと</p>
<p>できるようになるはずです。</p>
<ul>
<li>Android Studio でアプリを作成して実行する。</li>
<li>レイアウト・エディタを使用してConstraintLayout内のレイアウトを作成します。</li>
<li>レイアウト XML コードを編集します。</li>
<li>ボタンにonClick機能を追加する</li>
</ul>
<p>What you&#39;ll learn</p>
<ul>
<li>Android Studioで新規アクティビティを作成する方法</li>
<li>Up ナビゲーションの親アクティビティと子アクティビティを定義する方法</li>
<li>明示的なIntent でアクティビティを開始する方法</li>
<li>明示的なインテントを使用して各アクティビティ間でデータを渡す方法</li>
</ul>
<p>What you&#39;ll do</p>
<ul>
<li>メインアクティビティと2つ目のアクティビティを持つ新しいAndroidアプリを作成する</li>
<li>メインアクティビティからインテントを使用して2つ目のアクティビティにデータ（文字列）を渡し、そのデータを2つ目のアクティビティに表示します。</li>
<li>2番目の異なるビットのデータをメインアクティビティに送信します。</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="アプリの概要" duration="0">
        <p>この章では、当然のことながら、2つのActivityの実装を含むTwo Activitiesというアプリを作成し、ビルドします。アプリは3つのステージで作成します。</p>
<p>最初のステージでは、メインアクティビティに送信ボタンが1つ含まれているアプリを作成します。ユーザーがこのボタンをクリックすると、メインアクティビティはインテントを使用して2つ目のアクティビティを開始します。</p>
<p class="image-container"><img alt="Main Activity launches second Activity" style="width: 641.76px" src="img/170f0988e83e65fb.png"></p>
<p>第2段階では、メインアクティビティにEditTextビューを追加します。ユーザーがメッセージを入力し、[送信] をクリックします。メインアクティビティでは、インテントを使用して2つ目のアクティビティを開始し、ユーザーのメッセージを2つ目のアクティビティに送信します。2 番目のアクティビティは、受信したメッセージを表示します。</p>
<p class="image-container"><img alt="Main Activity sends a message to second Activity" style="width: 641.76px" src="img/703a750ac6e887c3.png"></p>
<p>2つのアクティビティアプリを作成する最終段階では、2つ目のアクティビティにEditTextとReplyボタンを追加します。これでユーザーは返信メッセージを入力して「返信」をタップすると、メインアクティビティに返信が表示されます。この時点で、インテントを使用して、2つ目のアクティビティからメインアクティビティに返信を受け渡します。</p>
<p class="image-container"><img alt="Second activity sends a reply back to main activity" style="width: 641.76px" src="img/72c5f62669fa22af.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="タスク1.TwoActivitiesプロジェクトを作成する" duration="0">
        <p>このタスクでは、メイン<code>アクティビティ</code>を持つ初期プロジェクトをセットアップし、レイアウトを定義し、<code>onClick</code>ボタン イベントのスケルトン メソッドを定義します。</p>
<p>1.1 TwoActivities プロジェクトの作成</p>
<ol type="1" start="1">
<li>Android Studioを起動し、新しいAndroid Studioプロジェクトを作成します。</li>
</ol>
<p>アプリに「TwoActivities」という名前をつけ、前回の実習で使用したものと同じ「Phone」と「Tablet」の設定を選択します。プロジェクトフォルダは自動的に<code>TwoActivities</code>という名前になり、アプリバーに表示されるアプリ名は「Two Activities」になります。</p>
<ol type="1" start="2">
<li><code>アクティビティ</code>のテンプレートに「Empty Activity」を選択します。次へ」をクリックします。</li>
<li>デフォルトの<code>アクティビティ</code>名<code>（MainActivity</code>）を受け入れます。レイアウト ファイルの生成と後方互換性（AppCompat）オプションがチェックされていることを確認します。</li>
<li>完了 をクリックします。</li>
</ol>
<p>1.2 メイン アクティビティのレイアウトを定義する</p>
<ol type="1" start="1">
<li>プロジェクト &gt; Android ペイン で res &gt; layout &gt; activity_main.xmlを開きます。レイアウトエディタが表示されます。</li>
<li>まだ選択されていない場合はデザインタブをクリックし、コンポーネントツリーペインの<code>テキストビュー</code>（&#34;Hello World&#34;と書かれているもの）を削除します。</li>
<li>Autoconnect をオンにした状態（デフォルト設定）で、パレットペインから<code>ボタンを</code>レイアウトの右下隅にドラッグします。オートコネクトは、<code>ボタンの</code>制約を作成します。</li>
<li>属性ペインで、ID を button_main に、layout_widthと layout_heightをwrap_content に設定し、Text フィールドにSendを入力します。これでレイアウトは次のようになります。</li>
</ol>
<p class="image-container"><img alt="Main Activity layout (first stage)" style="width: 408.27px" src="img/1ff9e83ac0bb3437.png"></p>
<ol type="1" start="5">
<li>TextタブをクリックしてXMLコードを編集します。<code>ボタン</code>に次の属性を追加します。</li>
</ol>
<p><code>アンドロイド:オンクリック="launchSecondActivity"</code></p>
<p><code>launchSecondActivity()</code>メソッドがまだ作成されていないため、属性値には赤で下線が引かれています。このエラーは次のタスクで修正します。</p>
<ol type="1" start="6">
<li>前回の実践で説明したように、&#34;Send&#34;用の文字列リソースを抽出し、リソースに<code>button_main</code>という名前を使用します。</li>
</ol>
<p><code>Button</code>のXMLコードは以下のようになります。</p>
<pre><code>&lt;Button
        android:id=&#34;@+id/button_main&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginBottom=&#34;16dp&#34;
        android:layout_marginRight=&#34;16dp&#34;
        android:text=&#34;@string/button_main&#34;
        android:onClick=&#34;launchSecondActivity&#34;
        app:layout_constraintBottom_toBottomOf=&#34;parent&#34;
        app:layout_constraintRight_toRightOf=&#34;parent&#34; /&gt;</code></pre>
<p>1.3 ボタンアクションの定義</p>
<p>このタスクでは、<code>android:onClick</code>属性のレイアウトで参照した<code>launchSecondActivity()</code>メソッドを実装します。</p>
<ol type="1" start="1">
<li>をクリックしてください。 <code>"launchSecondActivity"</code>を使用しています。</li>
<li><code>Alt+Enter</code>（Macの場合は<code>Option+Enter</code>）を押し、「MainActivity」の中の「Create &#39;launchSecondActivity(View)&#39;」を選択します。</li>
</ol>
<p><code>MainActivity</code>ファイルが開き、Android Studioが<code>launchSecondActivity</code>()ハンドラ用のスケルトン・メソッドを生成します。</p>
<ol type="1" start="3">
<li>launchSecond<code>Activity()</code>の中に、&#34;Button Clicked!</li>
</ol>
<p><code>Log.d(LOG_TAG, "Button clicked!");</code></p>
<p><code>LOG_TAGは</code>赤で表示されます。後のステップでその変数の定義を追加します。</p>
<ol type="1" start="4">
<li><code>MainActivity</code>クラスの先頭に、L<code>OG_TAG</code>変数の定数を追加します。</li>
</ol>
<pre><code>private static final String LOG_TAG = 
                            MainActivity.class.getSimpleName();</code></pre>
<p>この定数は、クラス自体の名前をタグとして使用します。</p>
<ol type="1" start="5">
<li>アプリを実行してください。送信ボタンをクリックすると、Logcatペインに「ボタンがクリックされました！」というメッセージが表示されます。モニターに出力が多すぎる場合は、検索ボックスにMainActivityと入力すると、Logcatペインにはそのタグに一致する行のみが表示されます。</li>
</ol>
<p>MainActivity<code>の</code>コードは以下のようになります。</p>
<pre><code>package com.example.android.twoactivities;

import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.util.Log;
import android.view.View;

public class MainActivity extends AppCompatActivity {
   private static final String LOG_TAG = 
                               MainActivity.class.getSimpleName();

   @Override
   protected void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       setContentView(R.layout.activity_main);
   }

   public void launchSecondActivity(View view) {
       Log.d(LOG_TAG, &#34;Button clicked!&#34;);
   }
}
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="タスク2：2つ目のアクティビティを作成して起動する" duration="0">
        <p>プロジェクトに追加した新しいアクティビティは、メインのアクティビティとは別に、独自のレイアウトとJavaファイルを持っています。また、<code>AndroidManifest.xml ファイル</code>内に独自の<code><activity></code>要素があります。メイン・アクティビティと同様に、Android Studioで作成する新しいアクティビティ実装も、<code>AppCompatActivity</code>クラスから拡張されます。</p>
<p>アプリ内の各アクティビティは、他のアクティビティとゆるやかに接続されているだけです。ただし、<code>AndroidManifest.xml</code>ファイルでアクティビティを別のアクティビティの親として定義することができます。この親子関係により、Androidは各アクティビティのタイトルバーに左向き矢印などのナビゲーションヒントを追加することができます。</p>
<p>アクティビティは、インテントを使って他のアクティビティ（同じアプリ内や異なるアプリ間で）と通信します。イン<code>テント</code>には、<em>明示的な</em>ものと暗黙<em>的な</em>ものがあります。</p>
<ul>
<li>明示的<em>な</em>インテントとは、そのインテントのターゲットが分かっているものです。</li>
<li>暗黙<em>的な</em>インテントとは、ターゲット・コンポーネントの名前を持っていないが、実行する一般的なアクションがある場合のものです。</li>
</ul>
<p>このタスクでは、独自のレイアウトを持つ2つ目のアクティビティをアプリに追加します。<code>AndroidManifest.xml</code>ファイルを変更して、メインアクティビティを2番目のアクティビティの親として定義します。次に、<code>MainActivity</code>の<code>launchSecondActivity()</code>メソッドを変更して、ボタンをクリックしたときに2つ目のアクティビティを起動するインテントを含むようにします。</p>
<p>2.1 2番目のアクティビティの作成</p>
<ol type="1" start="1">
<li>プロジェクトのアプリフォルダをクリックし、ファイル &gt; 新規作成 &gt; アクティビティ &gt; 空のアクティビティを選択します。</li>
<li>新しい<code>アクティビティ</code>にSecondActivity という名前を付けます。Generate Layout FileとBackwards Compatibility (AppCompat)がチェックされていることを確認します。レイアウト名は<code>activity_second</code> として記入します。Launcher Activityオプションはチェックし<em>ない</em>でください。</li>
<li>完了をクリックします。Android Studioは、新しい<code>アクティビティの</code>レイアウト（<code>activity_second.xml</code>）と新しいJavaファイル<code>（SecondActivity.java</code>）の両方をプロジェクトに追加します。また、<code>AndroidManifest.xml</code>ファイルも新しい<code>アクティビティ</code>を含むように更新されます。</li>
</ol>
<p>2.2 AndroidManifest.xmlファイルの変更</p>
<ol type="1" start="1">
<li>マニフェスト &gt; AndroidManifest.xmlを開きます。</li>
<li>Android Studioが2つ目の<code>Activity</code>用に作成した<code><activity></code>要素を探します。</li>
</ol>
<p><code><activity</code> <code>android:name=".SecondActivity"></activity></code></p>
<ol type="1" start="3">
<li><code><activity></code>要素全体を以下のように置き換えてください。</li>
</ol>
<pre><code>&lt;activity android:name=&#34;.SecondActivity&#34;
    android:label = &#34;Second Activity&#34;
    android:parentActivityName=&#34;.MainActivity&#34;&gt;
    &lt;meta-data
        android:name=&#34;android.support.PARENT_ACTIVITY&#34;
        android:value=
                  &#34;com.example.android.twoactivities.MainActivity&#34; /&gt;
&lt;/activity&gt;</code></pre>
<p><code>label</code>属性は、<code>アクティビティ</code>のタイトルをアプリバーに追加します。</p>
<p><code>parentActivityName</code>属性で、メインのアクティビティが2番目のアクティビティの親であることを示します。この関係は、アプリ内の上向きナビゲーションに使用されます：2番目のアクティビティのアプリバーには左向きの矢印が表示され、ユーザーはメインアクティビティに「上向き」に移動できます。</p>
<p><code><meta-data></code>要素では、キーと値のペアの形でアクティビティに関する追加の任意の情報を提供します。この場合、メタデータ属性は、<code>android:parentActivityName</code>属性と同じことをします-上向きナビゲーションのための2つのアクティビティ間の関係を定義します。なぜなら、android<code>:</code>parentActivityName属性はAPIレベル16以上でのみ利用可能だからです。</p>
<ol type="1" start="4">
<li>上記のコードで&#34;Second Activity&#34;の文字列リソースを抽出し、リソース名として<code>activity2_name</code>を使用します。</li>
</ol>
<p>2.3 2番目のアクティビティのレイアウトを定義する</p>
<ol type="1" start="1">
<li>activity_second.xmlを開き、まだ選択されていない場合はDesignタブをクリックします。</li>
<li>パレットペインからTextViewをレイアウトの左上にドラッグし、レイアウトの上部と左側に制約を追加します。属性ペインでその属性を以下のように設定します。</li>
</ol>
<table>
<tr><td colspan="1" rowspan="1"><p>Attribute</p>
</td><td colspan="1" rowspan="1"><p>Value</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>id</code></p>
</td><td colspan="1" rowspan="1"><p><code>text_header</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Top margin</p>
</td><td colspan="1" rowspan="1"><p><code>16</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Left margin</p>
</td><td colspan="1" rowspan="1"><p><code>8</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>layout_width</code></p>
</td><td colspan="1" rowspan="1"><p><code>wrap_content</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>layout_height</code></p>
</td><td colspan="1" rowspan="1"><p><code>wrap_content</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>text</code></p>
</td><td colspan="1" rowspan="1"><p><code>Message Received</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>textAppearance</code></p>
</td><td colspan="1" rowspan="1"><p><code>AppCompat.Medium</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>textStyle</code></p>
</td><td colspan="1" rowspan="1"><p><code>B</code> (bold)</p>
</td></tr>
</table>
<p>textAppearanceの値は、基本的なフォントスタイルを定義する特別なAndroidテーマ属性です。テーマについての詳細は後のレッスンで学びます。</p>
<p>これでレイアウトは次のようになるはずです。</p>
<p class="image-container"><img alt="Second Activity layout (first stage) " style="width: 308.57px" src="img/d505e47d07ddd850.png"></p>
<ol type="1" start="3">
<li>TextタブをクリックしてXMLコードを編集し、&#34;Message Received&#34;文字列を<code>text_header</code>という名前のリソースに抽出します。</li>
<li>android<code>:layout_marginLeft="8dp"</code>属性を<code>TextView</code>に追加し、古いバージョンのAndroidの<code>layout_marginStart</code>属性を補完します。</li>
</ol>
<p><code>activity_second.xml</code>のXMLコードは以下のようにします。</p>
<pre><code>&lt;android.support.constraint.ConstraintLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
    xmlns:app=&#34;http://schemas.android.com/apk/res-auto&#34;
    xmlns:tools=&#34;http://schemas.android.com/tools&#34;
    android:layout_width=&#34;match_parent&#34;
    android:layout_height=&#34;match_parent&#34;
    tools:context=&#34;com.example.android.twoactivities.SecondActivity&#34;&gt;

    &lt;TextView
        android:id=&#34;@+id/text_header&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginStart=&#34;8dp&#34;
        android:layout_marginLeft=&#34;8dp&#34;
        android:layout_marginTop=&#34;16dp&#34;
        android:text=&#34;@string/text_header&#34;
        android:textAppearance=
                          &#34;@style/TextAppearance.AppCompat.Medium&#34;
        android:textStyle=&#34;bold&#34;
        app:layout_constraintStart_toStartOf=&#34;parent&#34;
        app:layout_constraintTop_toTopOf=&#34;parent&#34; /&gt;
&lt;/android.support.constraint.ConstraintLayout&gt;</code></pre>
<p>2.4 メインアクティビティにインテントを追加する</p>
<p>このタスクでは、<code>メインアクティビティ</code>に明示的なインテント<code>を</code>追加します。この<code>Intent</code>は、送信ボタンがクリックされたときに 2 番目の<code>アクティビティを</code>アクティブにするために使用されます。</p>
<ol type="1" start="1">
<li>MainActivity を開きます。</li>
<li><code>launchSecondActivity()</code>メソッドで新しい<code>Intent</code>を作成します。</li>
</ol>
<p>Intent コンストラクタは、明示的な<code>Intent</code> の 2 つの引数を取ります。 <a href="https://developer.android.com/reference/android/content/Context.html" target="_blank"><code>コンテキスト</code></a>と、その<code>Intent を</code>受け取る特定のコンポーネントを指定します。ここでは、<code>これを</code> <code>コンテキスト</code>として使用し、<code>SecondActivity.class を</code>特定のクラスとして使用します。</p>
<p><code>Intent intent = new</code> <code>Intent(this, SecondActivity.class);</code></p>
<ol type="1" start="3">
<li>新しい<code>Intent を</code>引数として<code>startActivity()</code>メソッドを呼び出します。</li>
</ol>
<p><code>startActivity(intent);</code></p>
<ol type="1" start="4">
<li>アプリを実行します。</li>
</ol>
<p>送信ボタンをクリックすると、<code>MainActivity が</code> <code>Intent</code>を送信し、Android システムが<code>SecondActivity</code> を起動し、画面に表示されます。<code>MainActivity</code>に戻るには、上ボタン（アプリバーの左矢印）または画面下部の戻るボタンをクリックします。</p>


      </google-codelab-step>
    
      <google-codelab-step label="タスク3：MainActivityからSecondActivityにデータを送信する" duration="0">
        <p>最後のタスクでは、<code>MainActivity</code>に明示的なインテントを追加して<code>SecondActivityを</code>起動しました。また、インテントを使用して、あるアクティビティを起動している間に、あるアクティビティから別のアクティビティに<em>データを送信する</em>こともできます。</p>
<p>インテントオブジェクトは、2つの方法でターゲットアクティビティにデータを渡すことができます。インテントデータは、アクションする特定のデータを示すURIです。インテントを通してアクティビティに渡したい情報が URI ではない場合や、送信したい情報が複数ある場合は、代わりに追加の情報を<em>エクストラ</em>に入れることができます。</p>
<p><em>インテントエクストラ</em>は <a href="https://developer.android.com/reference/android/os/Bundle.html" target="_blank"><code>バンドル</code></a>.<code>バンドル</code>はデータの集合体で、キーと値のペアとして格納されています。あるアクティビティから別のアクティビティに情報を渡すには、送信側のアクティビティからIntent extra<code>Bundle</code>にキーと値を入れ、受信側のアクティビティでそれらを再び取り出します。</p>
<p>このタスクでは、<code>MainActivity</code>の明示的なインテントを修正して、追加のデータ（この場合は、ユーザーが入力した文字列）をインテントの追加<code>バンドル</code>に含めるようにします。次に、<code>SecondActivity を</code>修正して、そのデータを<code>インテント・エクストラ・バンドル</code>から取り出し、画面に表示します。</p>
<p>3.1 MainActivity のレイアウトに EditText を追加する</p>
<ol type="1" start="1">
<li>activity_main.xmlを開きます。</li>
<li>パレットペインからPlain Text<code>（EditText</code>）要素をレイアウトの下部にドラッグし、レイアウトの左側、レイアウトの下部、送信 <code>ボタン</code>の左側に制約を追加します。属性ペインでその属性を以下のように設定します。</li>
</ol>
<table>
<tr><td colspan="1" rowspan="1"><p>Attribute</p>
</td><td colspan="1" rowspan="1"><p>Value</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>id</code></p>
</td><td colspan="1" rowspan="1"><p><code>editText_main</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Right margin</p>
</td><td colspan="1" rowspan="1"><p><code>8</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Left margin</p>
</td><td colspan="1" rowspan="1"><p><code>8</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Bottom margin</p>
</td><td colspan="1" rowspan="1"><p><code>16</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>layout_width</code></p>
</td><td colspan="1" rowspan="1"><p><code>match_constraint</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>layout_height</code></p>
</td><td colspan="1" rowspan="1"><p><code>wrap_content</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>inputType</code></p>
</td><td colspan="1" rowspan="1"><p><code>textLongMessage</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>hint</code></p>
</td><td colspan="1" rowspan="1"><p><code>Enter Your Message Here</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>text</code></p>
</td><td colspan="1" rowspan="1"><p>(Delete any text in this field)</p>
</td></tr>
</table>
<p><code>activity_main.xml</code>の新しいレイアウトは次のようになります。</p>
<p class="image-container"><img alt="Main Activity layout (second stage)" style="width: 294.16px" src="img/cd5302e2709828b7.png"></p>
<ol type="1" start="3">
<li>テキストタブをクリックしてXMLコードを編集し、&#34;ここにメッセージを入力してください&#34;という文字列を<code>editText_main</code>という名前のリソースに抽出します。</li>
</ol>
<p>レイアウトのXMLコードは以下のようになります。</p>
<pre><code>&lt;android.support.constraint.ConstraintLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
    xmlns:app=&#34;http://schemas.android.com/apk/res-auto&#34;
    xmlns:tools=&#34;http://schemas.android.com/tools&#34;
    android:layout_width=&#34;match_parent&#34;
    android:layout_height=&#34;match_parent&#34;
    tools:context=&#34;com.example.android.twoactivities.MainActivity&#34;&gt;

    &lt;Button
        android:id=&#34;@+id/button_main&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginBottom=&#34;16dp&#34;
        android:layout_marginRight=&#34;16dp&#34;
        android:text=&#34;@string/button_main&#34;
        android:onClick=&#34;launchSecondActivity&#34;
        app:layout_constraintBottom_toBottomOf=&#34;parent&#34;
        app:layout_constraintRight_toRightOf=&#34;parent&#34; /&gt;

    &lt;EditText
        android:id=&#34;@+id/editText_main&#34;
        android:layout_width=&#34;0dp&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginBottom=&#34;16dp&#34;
        android:layout_marginEnd=&#34;8dp&#34;
        android:layout_marginStart=&#34;8dp&#34;
        android:ems=&#34;10&#34;
        android:hint=&#34;@string/editText_main&#34;
        android:inputType=&#34;textLongMessage&#34;
        app:layout_constraintBottom_toBottomOf=&#34;parent&#34;
        app:layout_constraintEnd_toStartOf=&#34;@+id/button_main&#34;
        app:layout_constraintStart_toStartOf=&#34;parent&#34; /&gt;
&lt;/android.support.constraint.ConstraintLayout&gt;
</code></pre>
<p>3.2 Intentエクストラに文字列を追加する</p>
<p><code>インテントエクストラ</code> <em>は</em>、キー/値のペアを <a href="https://developer.android.com/reference/android/os/Bundle.html" target="_blank"><code>バンドル</code></a>.<code>バンドル</code>とは、キーと値のペアとして格納されたデータの集合体です。ある<code>アクティビティ</code>から別のアクティビティに情報を渡すには、送信側の<code>アクティビティ</code>から<code>Intent</code>の余分な<code>バンドル</code>にキーと値を入れ、受信側の<code>アクティビティ</code>でそれらを再び取り出す必要があります。</p>
<ol type="1" start="1">
<li>MainActivityを開きます。</li>
<li>クラスの先頭に<code>パブリック</code>定数を追加して、<code>Intent</code>エクストラのキーを定義します。</li>
</ol>
<pre><code>public static final String EXTRA_MESSAGE = 
                   &#34;com.example.android.twoactivities.extra.MESSAGE&#34;;</code></pre>
<ol type="1" start="3">
<li><code>EditTextを</code>保持するためにクラスの先頭にプライベート変数を追加します。</li>
</ol>
<pre><code>private EditText mMessageEditText;</code></pre>
<ol type="1" start="4">
<li><code>onCreate()</code>メソッドでは <a href="https://developer.android.com/reference/android/view/View.html#findViewById(int)" target="_blank"><code>findViewById()</code></a>を使用して<code>EditText</code>への参照を取得し、そのプライベート変数に代入します。</li>
</ol>
<pre><code>mMessageEditText = findViewById(R.id.editText_main);</code></pre>
<ol type="1" start="5">
<li><code>launchSecondActivity()</code>メソッドで、新しい<code>Intent</code>のすぐ下にある<code>EditText</code>のテキストを文字列として取得します。</li>
</ol>
<pre><code>String message = mMessageEditText.getText().toString();</code></pre>
<ol type="1" start="6">
<li>その文字列を、<code>EXTRA_MESSAGE</code>定数をキーに、文字列を値にして、余分なものとしてイン<code>テント</code>に追加します。</li>
</ol>
<pre><code>intent.putExtra(EXTRA_MESSAGE, message);</code></pre>
<p><code>MainActivity</code>の<code>onCreate()</code>メソッドは以下のようになるはずです。</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        mMessageEditText = findViewById(R.id.editText_main);
}</code></pre>
<p><code>MainActivity</code>の<code>launchSecondActivity()</code>メソッドは、以下のようになるはずです。</p>
<pre><code>public void launchSecondActivity(View view) {
        Log.d(LOG_TAG, &#34;Button clicked!&#34;);
        Intent intent = new Intent(this, SecondActivity.class);
        String message = mMessageEditText.getText().toString();
        intent.putExtra(EXTRA_MESSAGE, message);
        startActivity(intent);
}</code></pre>
<p>3.3 SecondActivityにメッセージ用のTextViewを追加する</p>
<ol type="1" start="1">
<li>activity_second.xmlを開きます。</li>
<li>別のTextViewをtext<code>_header</code> <code>TextView</code>の下のレイアウトにドラッグし、レイアウトの左側と<code>text_header</code>の下に制約を追加します。</li>
<li>属性ペインで新しい<code>TextView</code>属性を以下のように設定します。</li>
</ol>
<table>
<tr><td colspan="1" rowspan="1"><p>Attribute</p>
</td><td colspan="1" rowspan="1"><p>Value</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>id</code></p>
</td><td colspan="1" rowspan="1"><p><code>text_message</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Top margin</p>
</td><td colspan="1" rowspan="1"><p><code>8</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Left margin</p>
</td><td colspan="1" rowspan="1"><p><code>8</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>layout_width</code></p>
</td><td colspan="1" rowspan="1"><p><code>wrap_content</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>layout_height</code></p>
</td><td colspan="1" rowspan="1"><p><code>wrap_content</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>text</code></p>
</td><td colspan="1" rowspan="1"><p>(Delete any text in this field)</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>textAppearance</code></p>
</td><td colspan="1" rowspan="1"><p><code>AppCompat.Medium</code></p>
</td></tr>
</table>
<p>新しいレイアウトは前のタスクと同じように見えますが、新しい<code>TextView</code>にはテキストが含まれていないため、画面には表示されません。</p>
<p><code>activity_second.xml</code>レイアウトのXMLコードは以下のようになります。</p>
<pre><code>&lt;android.support.constraint.ConstraintLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
    xmlns:app=&#34;http://schemas.android.com/apk/res-auto&#34;
    xmlns:tools=&#34;http://schemas.android.com/tools&#34;
    android:layout_width=&#34;match_parent&#34;
    android:layout_height=&#34;match_parent&#34;
    tools:context=&#34;com.example.android.twoactivities.SecondActivity&#34;&gt;

    &lt;TextView
        android:id=&#34;@+id/text_header&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginStart=&#34;8dp&#34;
        android:layout_marginTop=&#34;16dp&#34;
        android:text=&#34;@string/text_header&#34;
        android:textAppearance=
                          &#34;@style/TextAppearance.AppCompat.Medium&#34;
        android:textStyle=&#34;bold&#34;
        app:layout_constraintStart_toStartOf=&#34;parent&#34;
        app:layout_constraintTop_toTopOf=&#34;parent&#34; /&gt;

    &lt;TextView
        android:id=&#34;@+id/text_message&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginStart=&#34;8dp&#34;
        android:layout_marginTop=&#34;8dp&#34;
        app:layout_constraintStart_toStartOf=&#34;parent&#34;
        app:layout_constraintTop_toBottomOf=&#34;@+id/text_header&#34; /&gt;
&lt;/android.support.constraint.ConstraintLayout&gt;</code></pre>
<p>3.4 SecondActivityを変更してエキストラを取得し、メッセージを表示する</p>
<ol type="1" start="1">
<li><code>onCreate()</code>メソッドにコードを追加するためにSecondActivity を開きます。</li>
<li>この<code>アクティビティを</code>アクティブにした<code>Intent</code>を取得します。</li>
</ol>
<p><code>Intent intent = getIntent();</code></p>
<ol type="1" start="3">
<li><code>MainActivity.EXTRA_MESSAGE</code>静的変数をキーにして、<code>インテントエクストラ</code>からメッセージを含む文字列を取得します。</li>
</ol>
<p><code>String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE);</code></p>
<ol type="1" start="4">
<li><code>findViewByID()を</code>使用して、レイアウトからメッセージの<code>TextView</code>への参照を取得します。</li>
</ol>
<p><code>TextView textView = findViewById(R.id.text_message);</code></p>
<ol type="1" start="5">
<li><code>TextViewの</code>テキストを<code>Intent</code>エクストラからの文字列に設定します。</li>
</ol>
<p><code>textView.setText(message);</code></p>
<ol type="1" start="6">
<li>アプリを実行します。<code>MainActivity</code>にメッセージを入力して送信をクリックすると、<code>SecondActivityが</code>起動してメッセージが表示されます。</li>
</ol>
<p><code>SecondActivity</code>の<code>onCreate()</code>メソッドは以下のようになっているはずです。</p>
<p><code>メソッドは次のようになります。</code></p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_second);
    Intent intent = getIntent();
    String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE);
    TextView textView = findViewById(R.id.text_message);
    textView.setText(message);
}</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="タスク4：メインアクティビティにデータを戻す" duration="0">
        <p>これで、新しいアクティビティを起動してデータを送信するアプリができたので、最後のステップは、2番目のアクティビティのデータをメインのアクティビティに戻すことです。このタスクには、インテントと<em>インテントエクストラ</em>も使用します。</p>
<p>4.1SecondActivityレイアウトにEditTextとButtonを追加する</p>
<ol type="1" start="1">
<li>strings.xml を開き、<code>Button</code>テキスト用の文字列リソースと<code>SecondActivity</code> に追加する<code>EditText</code>用のヒントを追加します。</li>
</ol>
<pre><code>&lt;string name=&#34;button_second&#34;&gt;Reply&lt;/string&gt;
&lt;string name=&#34;editText_second&#34;&gt;Enter Your Reply Here&lt;/string&gt;</code></pre>
<ol type="1" start="2">
<li>activity_main.xmlとactivity_second.xmlを開きます。</li>
<li><code>activity_main.xml</code>レイアウトファイルから<code>EditText</code>と<code>Buttonを</code>コピーし、act<code>ivity_second.xml</code>レイアウトに貼り付けます。</li>
<li><code>activity_second.xml</code>で、<code>Button</code>の属性値を以下のように修正します。</li>
</ol>
<table>
<tr><td colspan="1" rowspan="1"><p>古い属性値</p>
</td><td colspan="1" rowspan="1"><p>新しい属性値</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>android:id="@+id/button_main"</code></p>
</td><td colspan="1" rowspan="1"><p><code>android:id="@+id/button_second"</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>android:onClick=</code></p>
<p><code>"launchSecondActivity"</code></p>
</td><td colspan="1" rowspan="1"><p><code>android:onClick="returnReply"</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>android:text=</code></p>
<p><code>"@string/button_main"</code></p>
</td><td colspan="1" rowspan="1"><p><code>android:text=</code></p>
<p><code>"@string/button_second"</code></p>
</td></tr>
</table>
<ol type="1" start="5">
<li><code>activity_second.xml</code>で、<code>EditTextの</code>属性値を以下のように修正します。</li>
</ol>
<table>
<tr><td colspan="1" rowspan="1"><p>古い属性値</p>
</td><td colspan="1" rowspan="1"><p>新しい属性値</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>android:id="@+id/editText_main"</code></p>
</td><td colspan="1" rowspan="1"><p><code>android:id="@+id/editText_second"</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>app:layout_constraintEnd_toStartOf="@+id/button"</code></p>
</td><td colspan="1" rowspan="1"><p><code>app:layout_constraintEnd_toStartOf="@+id/button_second"</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>android:hint=</code></p>
<p><code>"@string/editText_main"</code></p>
</td><td colspan="1" rowspan="1"><p><code>android:hint=</code></p>
<p><code>"@string/editText_second"</code></p>
</td></tr>
</table>
<ol type="1" start="6">
<li>XMLレイアウトエディタでreturnReplyをクリックし、<code>Alt+Enter（</code>Macの場合は<code>Option+Return</code>）を押し、「SecondActivity」の中の「Create &#39;returnReply(View)&#39;」を選択します。</li>
</ol>
<p>Android Studio は<code>returnReply()</code>ハンドラ用のスケルトンメソッドを生成します。このメソッドを次のタスクで実装します。</p>
<p><code>activity_second.xml</code>の新しいレイアウトは次のようになります。</p>
<p class="image-container"><img alt="Second Activity layout (final stage)" style="width: 303.00px" src="img/4acbc21712a8e6f7.png"></p>
<p><code>activity_second.xml</code>レイアウト・ファイルのXMLコードは次のようになります。</p>
<pre><code>&lt;android.support.constraint.ConstraintLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
    xmlns:app=&#34;http://schemas.android.com/apk/res-auto&#34;
    xmlns:tools=&#34;http://schemas.android.com/tools&#34;
    android:layout_width=&#34;match_parent&#34;
    android:layout_height=&#34;match_parent&#34;
    tools:context=&#34;com.example.android.twoactivities.SecondActivity&#34;&gt;

    &lt;TextView
        android:id=&#34;@+id/text_header&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginStart=&#34;8dp&#34;
        android:layout_marginLeft=&#34;8dp&#34;
        android:layout_marginTop=&#34;16dp&#34;
        android:text=&#34;@string/text_header&#34;
        android:textAppearance=&#34;@style/TextAppearance.AppCompat.Medium&#34;
        android:textStyle=&#34;bold&#34;
        app:layout_constraintStart_toStartOf=&#34;parent&#34;
        app:layout_constraintTop_toTopOf=&#34;parent&#34; /&gt;

    &lt;TextView
        android:id=&#34;@+id/text_message&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginStart=&#34;8dp&#34;
        android:layout_marginLeft=&#34;8dp&#34;
        android:layout_marginTop=&#34;8dp&#34;
        app:layout_constraintStart_toStartOf=&#34;parent&#34;
        app:layout_constraintTop_toBottomOf=&#34;@+id/text_header&#34; /&gt;

    &lt;Button
        android:id=&#34;@+id/button_second&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginBottom=&#34;16dp&#34;
        android:layout_marginRight=&#34;16dp&#34;
        android:text=&#34;@string/button_second&#34;
        android:onClick=&#34;returnReply&#34;
        app:layout_constraintBottom_toBottomOf=&#34;parent&#34;
        app:layout_constraintRight_toRightOf=&#34;parent&#34; /&gt;

    &lt;EditText
        android:id=&#34;@+id/editText_second&#34;
        android:layout_width=&#34;0dp&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginBottom=&#34;16dp&#34;
        android:layout_marginEnd=&#34;8dp&#34;
        android:layout_marginStart=&#34;8dp&#34;
        android:ems=&#34;10&#34;
        android:hint=&#34;@string/editText_second&#34;
        android:inputType=&#34;textLongMessage&#34;
        app:layout_constraintBottom_toBottomOf=&#34;parent&#34;
        app:layout_constraintEnd_toStartOf=&#34;@+id/button_second&#34;
        app:layout_constraintStart_toStartOf=&#34;parent&#34; /&gt;
&lt;/android.support.constraint.ConstraintLayout&gt;</code></pre>
<p>4.2 2つ目のアクティビティでレスポンスインテントを作成する</p>
<p>2 番目の<code>アクティビティ</code>からメインの<code>アクティビティ</code>に戻ってくるレスポンスデータは、<code>Intent</code>エクストラで送信されます。この return<code>Intent</code>を構築し、送信する<code>Intent</code> と同じ方法でデータを入れます。</p>
<ol type="1" start="1">
<li>SecondActivityを開きます。</li>
<li>クラスの先頭に、<code>Intent</code>エクストラのキーを定義するための public 定数を追加します。</li>
</ol>
<pre><code>public static final String EXTRA_REPLY = 
                     &#34;com.example.android.twoactivities.extra.REPLY&#34;;</code></pre>
<ol type="1" start="3">
<li><code>EditTextを</code>保持するためにクラスの先頭にプライベート変数を追加します。</li>
</ol>
<p><code>private</code> <code>EditText mReply;</code></p>
<ol type="1" start="4">
<li><code>onCreate()</code>メソッドでは、<code>Intent</code>コードの前に<code>findViewByID() を</code>使用して<code>EditText</code>への参照を取得し、そのプライベート変数に代入します。</li>
</ol>
<p><code>mReply = findViewById(R.id.editText_second);</code></p>
<ol type="1" start="5">
<li><code>returnReply()</code>メソッドでは、<code>EditTextの</code>テキストを文字列として取得します。</li>
</ol>
<p><code>String reply = mReply.getText().toString();</code></p>
<ol type="1" start="6">
<li><code>returnReply()</code>メソッドでは、レスポンス用の新しいインテントを作成します<em>。</em></li>
</ol>
<p><code>Intent replyIntent = new</code> <code>Intent();</code></p>
<ol type="1" start="7">
<li><code>EditText</code>からの<code>返信</code>文字列を<code>Intent</code>の<em>エクストラ</em>として新しいインテントに追加します。エクストラ<em>は</em>キーと値のペアなので、ここではキーが<code>EXTRA_REPLY</code>、値が<code>返信</code>です。</li>
</ol>
<p><code>replyIntent.putExtra(EXTRA_REPLY, reply);</code></p>
<ol type="1" start="8">
<li>レスポンスが成功したことを示すために結果を<code>RESULT_OK</code>に設定します。その結果をRESULT_OKに設定して、レスポンスが成功したことを示します。 <a href="https://developer.android.com/reference/android/app/Activity.html" target="_blank"><code>活動内容</code></a>クラスは<code>RESULT_OK</code>と<code>RESULT_CANCELLED</code> を含む結果コードを定義します。</li>
</ol>
<p><code>setResult(RESULT_OK,replyIntent);</code></p>
<ol type="1" start="9">
<li><code>アクティビティを</code>閉じて<code>MainActivity</code> に戻るために<code>finish() を</code>呼び出します。</li>
</ol>
<p><code>finish();</code></p>
<pre><code>public class SecondActivity extends AppCompatActivity {
    public static final String EXTRA_REPLY =
                         &#34;com.example.android.twoactivities.extra.REPLY&#34;;
    private EditText mReply;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_second);
        mReply = findViewById(R.id.editText_second);
        Intent intent = getIntent();
        String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE);
        TextView textView = findViewById(R.id.text_message);
        textView.setText(message);
    }

    public void returnReply(View view) {
        String reply = mReply.getText().toString();
        Intent replyIntent = new Intent();
        replyIntent.putExtra(EXTRA_REPLY, reply);
        setResult(RESULT_OK, replyIntent);
        finish();
    }
}</code></pre>
<p>4.3返信を表示するためのTextView要素の追加</p>
<p><code>MainActivityには</code>、<code>SecondActivityが</code>送信した返信を表示する方法が必要です。このタスクでは、<code>MainActivity</code>の返信を表示するために、Activity<code>_main.xml</code>レイアウトに<code>TextView</code>要素を追加します。</p>
<p>このタスクを簡単にするために、<code>SecondActivity</code>で使用した<code>TextView</code>要素をコピーします。</p>
<ol type="1" start="1">
<li>strings.xmlを開き、返信ヘッダー用の文字列リソースを追加します。</li>
</ol>
<p><code><string</code> <code>name="text_header_reply">Reply Received</string></code></p>
<ol type="1" start="2">
<li>activity_main.xmlとactivity_second.xmlを開きます。</li>
<li><code>activity_second.xml</code>レイアウトファイルから2つの<code>TextView</code>要素をコピーし、<code>Buttonの</code>上のact<code>ivity_main.xml</code>レイアウトに貼り付けます。</li>
<li>activity<code>_main.xml</code>で、最初の<code>TextView</code>の属性値を以下のように修正します。</li>
</ol>
<table>
<tr><td colspan="1" rowspan="1"><p>古い属性値</p>
</td><td colspan="1" rowspan="1"><p>新しい属性値</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>android:id="@+id/text_header"</code></p>
</td><td colspan="1" rowspan="1"><p><code>android:id="@+id/text_header_reply"</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>android:text=</code></p>
<p><code>"@string/text_header"</code></p>
</td><td colspan="1" rowspan="1"><p><code>android:text=</code></p>
<p><code>"@string/text_header_reply"</code></p>
</td></tr>
</table>
<ol type="1" start="5">
<li><code>activity_main.xml</code>で、2番目の<code>TextViewの</code>属性値を以下のように変更します。</li>
</ol>
<table>
<tr><td colspan="1" rowspan="1"><p>古い属性値</p>
</td><td colspan="1" rowspan="1"><p>新しい属性値</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>android:id="@+id/text_message"</code></p>
</td><td colspan="1" rowspan="1"><p><code>android:id= "@+id/text_message_reply"</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><code>app:layout_constraintTop_toBottomOf="@+id/text_header"</code></p>
</td><td colspan="1" rowspan="1"><p><code>app:layout_constraintTop_toBottomOf="@+id/text_header_reply"</code></p>
</td></tr>
</table>
<ol type="1" start="6">
<li>それぞれの<code>TextView</code>に<code>android:visibility</code>属性を追加して、最初は見えないようにします。(画面上に表示されていても、何も内容がないと、ユーザーが混乱することがあります)。</li>
</ol>
<p><code>android:visibility="invisible"</code></p>
<p>これらの<code>TextView</code>要素は、レスポンスデータが2つ目の<code>アクティビティ</code>から渡された後に表示されます。</p>
<p><code>activity_main.xmlの</code>レイアウトは前のタスクと同じように見えますが、レイアウトに2つの新しい<code>TextView</code>要素を追加しました。これらの要素を不可視に設定しているため、画面には表示されません。</p>
<p>以下は、<code>activity_main.xml</code>ファイルのXMLコードです。</p>
<pre><code>&lt;android.support.constraint.ConstraintLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
    xmlns:app=&#34;http://schemas.android.com/apk/res-auto&#34;
    xmlns:tools=&#34;http://schemas.android.com/tools&#34;
    android:layout_width=&#34;match_parent&#34;
    android:layout_height=&#34;match_parent&#34;
    tools:context=&#34;com.example.android.twoactivities.MainActivity&#34;&gt;

    &lt;TextView
        android:id=&#34;@+id/text_header_reply&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginStart=&#34;8dp&#34;
        android:layout_marginLeft=&#34;8dp&#34;
        android:layout_marginTop=&#34;16dp&#34;
        android:text=&#34;@string/text_header_reply&#34;
        android:textAppearance=&#34;@style/TextAppearance.AppCompat.Medium&#34;
        android:textStyle=&#34;bold&#34;
        android:visibility=&#34;invisible&#34;
        app:layout_constraintStart_toStartOf=&#34;parent&#34;
        app:layout_constraintTop_toTopOf=&#34;parent&#34; /&gt;

    &lt;TextView
        android:id=&#34;@+id/text_message_reply&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginStart=&#34;8dp&#34;
        android:layout_marginLeft=&#34;8dp&#34;
        android:layout_marginTop=&#34;8dp&#34;
        android:visibility=&#34;invisible&#34;
        app:layout_constraintStart_toStartOf=&#34;parent&#34;
        app:layout_constraintTop_toBottomOf=&#34;@+id/text_header_reply&#34; /&gt;

    &lt;Button
        android:id=&#34;@+id/button2&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginBottom=&#34;16dp&#34;
        android:layout_marginRight=&#34;16dp&#34;
        android:text=&#34;@string/button_main&#34;
        android:onClick=&#34;launchSecondActivity&#34;
        app:layout_constraintBottom_toBottomOf=&#34;parent&#34;
        app:layout_constraintRight_toRightOf=&#34;parent&#34; /&gt;

    &lt;EditText
        android:id=&#34;@+id/editText_main&#34;
        android:layout_width=&#34;0dp&#34;
        android:layout_height=&#34;wrap_content&#34;
        android:layout_marginBottom=&#34;16dp&#34;
        android:layout_marginEnd=&#34;8dp&#34;
        android:layout_marginStart=&#34;8dp&#34;
        android:ems=&#34;10&#34;
        android:hint=&#34;@string/editText_main&#34;
        android:inputType=&#34;textLongMessage&#34;
        app:layout_constraintBottom_toBottomOf=&#34;parent&#34;
        app:layout_constraintEnd_toStartOf=&#34;@+id/button2&#34;
        app:layout_constraintStart_toStartOf=&#34;parent&#34; /&gt;
&lt;/android.support.constraint.ConstraintLayout&gt;</code></pre>
<p>4.4 Intent extraからの返信を取得して表示する</p>
<p>明示的な<code>Intent</code>を使用して別の<code>アクティビティ</code> <code>を</code>開始する場合、データの取得は期待できないかもしれません。その場合は、先ほどの実践で行ったように<code>startActivity() を</code>使用して新しい<code>アクティビティ</code>を開始します。しかし、アクティベートされた<code>アクティビティ</code>からデータを取得したい場合は、<code>startActivityForResult()</code>を使用してアクティベートを開始する必要があります。</p>
<p>このタスクでは、結果を期待して<code>SecondActivityを</code>起動し、その戻りデータを<code>Intent</code>から抽出し、前回のタスクで作成した<code>TextView</code>要素にそのデータを表示するようにアプリを修正します。</p>
<ol type="1" start="1">
<li>MainActivityを開きます。</li>
<li>クラスの先頭に公開定数を追加して、興味のある特定のタイプのレスポンスのキーを定義します。</li>
</ol>
<p><code>public</code> <code>static</code> <code>final</code> <code>int TEXT_REQUEST = 1;</code></p>
<ol type="1" start="3">
<li>返信ヘッダと返信<code>TextView</code>要素を保持するために2つのプライベート変数を追加します。</li>
</ol>
<p><code>private</code> <code>TextView mReplyHeadTextView;</code></p>
<p><code>private</code> <code>TextView mReplyTextView;</code></p>
<ol type="1" start="4">
<li><code>onCreate()</code>メソッドで、<code>findViewByID() を</code>使用して、レイアウトから返信ヘッダーと返信<code>テキストビュー</code>要素への参照を取得します。これらのビューインスタンスをプライベート変数に代入します。</li>
</ol>
<p><code>mReplyHeadTextView = findViewById(R.id.text_header_reply);</code></p>
<p><code>mReplyTextView = findViewById(R.id.text_message_reply);</code></p>
<p>完全な<code>onCreate()</code>メソッドは次のようになります。</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        mMessageEditText = findViewById(R.id.editText_main);
        mReplyHeadTextView = findViewById(R.id.text_header_reply);
        mReplyTextView = findViewById(R.id.text_message_reply);
}</code></pre>
<ol type="1" start="5">
<li><code>launchSecondActivity</code>()メソッドで、startAct<code>ivity()</code>の呼び出しを<code>startActivityForResult()</code>に変更し、引数に<code>TEXT_REQUEST</code>キーを含めます。</li>
</ol>
<p><code>startActivityForResult(intent, TEXT_REQUEST);</code></p>
<ol type="1" start="6">
<li>このシグネチャで<code>onActivityResult()</code>コールバックメソッドをオーバーライドします。</li>
</ol>
<pre><code>@Override
public void onActivityResult(int requestCode, 
                             int resultCode, Intent data) {
}</code></pre>
<p><code>onActivityResult(</code>)の3つの引数には、戻りデータを処理するために必要なすべての情報が含まれています:<code>startActivityForResult()</code>で<code>アクティビティ</code>を起動したときに設定した<code>requestCode</code>、起動した<code>アクティビティ</code>で設定した<code>resultCode</code>(通常は<code>RESULT_OK</code>または<code>RESULT_CANCELED</code>のいずれか)、および起動した<code>アクティビティ</code>から返されたデータを含む<code>Intentデータ</code>です。</p>
<ol type="1" start="7">
<li><code>onActivityResult</code>()の中で、<code>super.onActivityResult()</code>を呼び出します。</li>
</ol>
<p><code>super.onActivityResult(requestCode, resultCode, data);</code></p>
<ol type="1" start="8">
<li><code>TEXT_REQUEST</code>をテストするコードを追加して、正しい<code>Intent</code>の結果を処理していることを確認します。また、<code>RESULT_OK</code> をテストして、リクエストが成功したことを確認します。</li>
</ol>
<pre><code>if (requestCode == TEXT_REQUEST) {
    if (resultCode == RESULT_OK) { 
    }
}</code></pre>
<p>そのためには <a href="https://developer.android.com/reference/android/app/Activity.html" target="_blank"><code>活動内容</code></a>クラスは結果コードを定義します。コードは<code>RESULT_OK</code>(リクエストが成功した)、<code>RESULT_CANCELED</code>(ユーザーが操作をキャンセルした)、RESULT_<code>FIRST_USER</code>(独自の結果コードを定義するためのもの) のいずれかです。</p>
<ol type="1" start="9">
<li>内側の if ブロックの中で、レスポンス<code>Intent(data</code>) から<code>Intent</code>のエクストラを取得します。ここで、extra のキーは<code>SecondActivity</code> の<code>EXTRA_REPLY</code>定数です。</li>
</ol>
<pre><code>String reply = data.getStringExtra(SecondActivity.EXTRA_REPLY);</code></pre>
<ol type="1" start="10">
<li>返信ヘッダーの可視性をtrueに設定します。</li>
</ol>
<p><code>mReplyHeadTextView.setVisibility(View.VISIBLE);</code></p>
<ol type="1" start="11">
<li>返信<code>テキストビューの</code>テキストを<code>返信</code>に設定し、その可視性をtrueに設定します。</li>
</ol>
<pre><code>mReplyTextView.setText(reply);
mReplyTextView.setVisibility(View.VISIBLE);</code></pre>
<p>完全な<code>onActivityResult()</code>メソッドは次のようになります。</p>
<pre><code>@Override
public void onActivityResult(int requestCode, 
                             int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if (requestCode == TEXT_REQUEST) {
        if (resultCode == RESULT_OK) {
            String reply = 
                    data.getStringExtra(SecondActivity.EXTRA_REPLY);
            mReplyHeadTextView.setVisibility(View.VISIBLE);
            mReplyTextView.setText(reply);
            mReplyTextView.setVisibility(View.VISIBLE);
        }
    }
}</code></pre>
<ol type="1" start="12">
<li>アプリを実行します。</li>
</ol>
<p>これで、2つ目の<code>アクティビティ</code>にメッセージを送信して返信が来ると、メインの<code>アクティビティ</code>が更新されて返信が表示されるようになりました。</p>
<p class="image-container"><img alt="Main Activity, final result" style="width: 235.15px" src="img/e1c10fcdbf9a7e75.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Solution code" duration="0">
        <p>Android Studioプロジェクト。 <a href="https://github.com/google-developer-training/android-fundamentals-apps-v2/tree/master/TwoActivities" target="_blank">TwoActivities</a></p>


      </google-codelab-step>
    
      <google-codelab-step label="Coding challenge" duration="0">
        <p>注意:コーディングの課題はすべて任意であり、後のレッスンの前提条件ではありません。</p>
<p>課題。 テキスト 1、テキスト2、テキスト 3 とラベルの付いた 3 つの<code>Button</code>要素を持つアプリを作成します。これらの<code>Button</code>要素のいずれかがクリックされると、2 つ目の<code>アクティビティを</code>起動します。2 つ目の<code>アクティビティ</code>には、3 つのテキスト パッセージのうちの 1 つを表示する<code>ScrollView</code>を含める必要があります (任意のパッセージを含めることができます)。イン<code>テント</code>を使用して、3つのパッセージのうちどのパッセージを表示するかを指定して、2つ目の<code>アクティビティ</code>を起動します。</p>


      </google-codelab-step>
    
      <google-codelab-step label="Summary" duration="0">
        <ul>
<li><code>アクティビティ</code>は、単一のユーザー タスクに焦点を当てた単一の画面を提供するアプリ コンポーネントです。</li>
<li>各<code>アクティビティ</code>には、独自のユーザー インターフェイス レイアウト ファイルがあります。</li>
<li>アクティビティ<code>の</code>実装に親子関係を割り当てることで、アプリ内でのアップ ナビゲーションを有効にすることができます。</li>
<li><code>ビュー</code>は、<code>android:visibility</code>属性を使用して表示または非表示にすることができます。</li>
</ul>
<p><code>アクティビティ</code>を実装するには</p>
<ul>
<li>ファイル &gt; 新規作成 &gt; アクティビティを選択してテンプレートから開始し、次の手順を自動的に実行します。</li>
<li>テンプレートから開始しない場合は、<code>Activity</code>Java クラスを作成し、関連する XML レイアウト・ファイルに<code>Activity</code>の基本的な UI を実装し、AndroidManifest.xml で新しい<code>Activity を</code>宣言します。</li>
</ul>
<p>イン<code>テント</code>。</p>
<ul>
<li>イン<code>テント</code>: インテントを使用すると、アプリ内の別のコンポーネントにアクション<code>を</code>要求することができます。イン<code>テント</code>には、明示的なものと暗黙的なものがあります。</li>
<li>明示的なイン<code>テント</code>では、データを受け取る特定のターゲット コンポーネントを指定します。</li>
<li>暗黙のインテント<code>を</code>使用すると、必要な機能は指定できますが、ターゲット コンポーネントは指定できません。</li>
<li>イン<code>テント</code>には、アクションを実行するためのデータ（URIとして）や追加情報を<em>インテント・エクストラ</em>として含めることができます。</li>
<li><code>Intent</code>extr<em>asは</em>、<code>Bundle</code>内のキーと値のペアで、<code>Intent</code>と一緒に送信されます。</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Related concept" duration="0">
        <p>関連する概念のドキュメントは、2<a href="https://google-developer-training.github.io/android-developer-fundamentals-course-concepts-v2/unit-1-get-started/lesson-2-activities-and-intents/2-1-c-activities-and-intents/2-1-c-activities-and-intents.html" target="_blank">.1</a>にある。<a href="https://google-developer-training.github.io/android-developer-fundamentals-course-concepts-v2/unit-1-get-started/lesson-2-activities-and-intents/2-1-c-activities-and-intents/2-1-c-activities-and-intents.html" target="_blank">活動と意図</a>にあります。</p>


      </google-codelab-step>
    
      <google-codelab-step label="Learn more" duration="0">
        <p>Android Studio のドキュメント。</p>
<ul>
<li><a href="https://developer.android.com/studio/intro/index.html" target="_blank">Android Studio の紹介</a></li>
</ul>
<p>Androidの開発者向けドキュメント。</p>
<ul>
<li><a href="http://developer.android.com/guide/components/fundamentals.html" target="_blank">アプリケーションの基礎</a></li>
<li><a href="http://developer.android.com/guide/components/activities.html" target="_blank">活動内容</a></li>
<li><a href="http://developer.android.com/guide/components/intents-filters.html" target="_blank">インテントとインテントフィルター</a></li>
<li><a href="https://developer.android.com/training/design-navigation/ancestral-temporal" target="_blank">バックとアップのナビゲーションをデザインする</a></li>
<li><a href="http://developer.android.com/reference/android/app/Activity.html" target="_blank"><code>活動内容</code></a></li>
<li><a href="http://developer.android.com/reference/android/content/Intent.html" target="_blank"><code>意図</code></a></li>
<li><a href="https://developer.android.com/reference/android/widget/ScrollView.html" target="_blank"><code>スクロールビュー</code></a></li>
<li><a href="http://developer.android.com/reference/android/view/View.html" target="_blank"><code>ビュー</code></a></li>
<li><a href="http://developer.android.com/reference/android/widget/Button.html" target="_blank"><code>ボタン</code></a></li>
<li><a href="http://developer.android.com/reference/android/widget/TextView.html" target="_blank"><code>テキストビュー</code></a></li>
<li><a href="https://developer.android.com/guide/topics/resources/string-resource.html" target="_blank">文字列リソース</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Homework" duration="0">
        <p>このセクションでは、インストラクターが主導するコースの一部として、このコードラボを通して作業する学生のための可能な宿題をリストアップします。以下のことを行うのはインストラクター次第です。</p>
<ul>
<li>必要に応じて宿題を割り当てる。</li>
<li>宿題の提出方法を学生に伝える。</li>
<li>宿題の割り当てを評価します。</li>
</ul>
<p>講師は、これらの提案を少しでも多くのように使用することができますし、彼らが適切であると感じる他の宿題を割り当てるために自由に感じる必要があります。</p>
<p>あなた自身でこのコードラボを介して作業している場合は、あなたの知識をテストするためにこれらの宿題の割り当てを使用して自由に感じています。</p>
<h2 is-upgraded>Build and run an app</h2>
<p>前回の実践コードラボで作成したHelloToastアプリを開きます。</p>
<p>Toastボタンを変更して、以下のように「Hello！」という言葉と現在のカウントを表示する新しいアクティビティを起動するようにします。</p>
<p>ToastボタンのテキストをSay Helloに変更します。</p>
<p class="image-container"><img alt="1fffd3c1b8d09d64.png" style="width: 466.53px" src="img/1fffd3c1b8d09d64.png"></p>
<h2 is-upgraded>Answer these questions</h2>
<p>以下の質問に答えてください。</p>
<p>質問1</p>
<p>ファイル] &gt; [新規作成] &gt; [アクティビティ]とアクティビティ テンプレートを選択して、アプリに2つ目のアクティビティを追加すると、どのような変更が行われますか？1つを選択します。</p>
<p>2 番目のアクティビティは Java クラスとして追加されます。XML レイアウト ファイルを追加する必要があります。</p>
<p>2 番目のアクティビティ XML レイアウト ファイルが作成され、Java クラスが追加されます。クラス・シグネチャを定義する必要があります。</p>
<p>2 番目のアクティビティが Java クラスとして追加され、XML レイアウト・ファイルが作成され、AndroidManifest.xml ファイルが変更され、2 番目のアクティビティが宣言されます。</p>
<p>2つ目のアクティビティのXMLレイアウトファイルを作成し、AndroidManifest.xmlファイルを変更して2つ目のアクティビティを宣言します。</p>
<p>質問2</p>
<p>AndroidManifest.xmlファイルの2番目のActivity宣言からandroid:parentActivityNameと&lt;meta-data&gt;要素を削除するとどうなりますか？1つ選択してください。</p>
<p>2 番目のアクティビティを明示的な Intent で起動しようとすると、2 番目のアクティビティが表示されなくなりました。</p>
<p>2 番目の Activity XML レイアウト ファイルが削除されます。</p>
<p>2 番目のアクティビティで、ユーザーをメイン アクティビティに戻すための [戻る] ボタンが機能しなくなりました。</p>
<p>2 番目のアクティビティで、親アクティビティにユーザーを戻すためのアプリ バーの [上へ] ボタンが表示されなくなりました。</p>
<p>質問3</p>
<p>新しい明示的な Intent を作成するために使用するコンストラクタ・メソッドはどれですか? 1つ選んでください。</p>
<p>新しい Intent()</p>
<p>new Intent(Context context, Class&lt;?&gt; class)</p>
<p>new Intent(String action, Uri uri)</p>
<p>new Intent(String action)</p>
<p>質問4</p>
<p>HelloToastアプリの宿題では、カウントの現在値をIntentに追加する方法を教えてください。1つを選択してください。</p>
<p>インテントのデータとして</p>
<p>インテント TEXT_REQUEST として</p>
<p>インテントアクションとして</p>
<p>インテントエクストラとして</p>
<p>質問5</p>
<p>HelloToastアプリの宿題で、2回目の「Hello」アクティビティで現在のカウントを表示する方法を教えてください。1つ選びます。</p>
<p>アクティビティが起動したIntentを取得します。</p>
<p>Intentから現在のカウント値を取得します。</p>
<p>カウントのTextViewを更新する。</p>
<p>上記のすべてを行います。</p>
<p>アプリを提出して採点を受ける</p>
<p>学年別ガイダンス</p>
<p>アプリが以下の機能を持っていることを確認してください。</p>
<p>Toastボタンの代わりにSay Helloボタンが表示される。</p>
<p>Say Helloボタンが押されると2つ目のアクティビティが起動し、「Hello！」というメッセージとMainActivityからの現在のカウントが表示されます。</p>
<p>2つ目のアクティビティのJavaとXMLレイアウトファイルがプロジェクトに追加されました。</p>
<p>2つ目のアクティビティのXMLレイアウトファイルには、2つのTextView要素が含まれており、1つは &#34;Hello!&#34;という文字列、もう1つはカウントを表示します。</p>
<p>これには、（MainActivityの）Say Helloボタンのクリックハンドラメソッドの実装が含まれています。</p>
<p>2 番目のアクティビティの onCreate() メソッドの実装を含み、MainActivity からのカウントでカウントの TextView を更新します。</p>


      </google-codelab-step>
    
      <google-codelab-step label="13。Next codelab" duration="0">
        <p>Android Developer Fundamentals (V2)コースの次の実践的なコードラボを探すには、Codelabs for Android Developer Fundamentals (V2)を参照してください。</p>
<p>概念章、アプリ、スライドへのリンクを含むコースの概要については、Android Developer Fundamentals (Version 2)を参照してください。</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
